





<!DOCTYPE html>
<!--[if IE 9]><html class="no-js ie9" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en-US"><!--<![endif]-->

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Segmenting characters from license plates | PyImageSearch Gurus</title>
<link rel="pingback" href="https://gurus.pyimagesearch.com/xmlrpc.php"><link rel="shortcut icon" href="//www.pyimagesearch.com/wp-content/themes/canvas/favicon.ico"><link rel="alternate" type="application/rss+xml" title="PyImageSearch Gurus &raquo; Feed" href="https://gurus.pyimagesearch.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="PyImageSearch Gurus &raquo; Comments Feed" href="https://gurus.pyimagesearch.com/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"https:\/\/gurus.pyimagesearch.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='usernoise-button-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/css/button.css?ver=3.7.20' type='text/css' media='all' />
<link rel='stylesheet' id='usernoise-form-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/css/form.css?ver=3.7.20' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/vendor/font-awesome/css/font-awesome.css?ver=3.7.20' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://gurus.pyimagesearch.com/wp-includes/css/dashicons.min.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='thickbox-css'  href='https://gurus.pyimagesearch.com/wp-includes/js/thickbox/thickbox.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-arduino-ide-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/crayon-syntax-highlighter/themes/arduino-ide/arduino-ide.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-ubuntu-mono-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/crayon-syntax-highlighter/fonts/ubuntu-mono.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='gurus_remodal_css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/css/remodal.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='gurus_remodal_theme_css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/css/remodal-default-theme.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='gurus_sample_lesson_css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/css/gurus_sample_lessons.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='mp-theme-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/memberpress/css/ui/theme.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpProQuiz_front_style-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/includes/vendor/wp-pro-quiz/css/wpProQuiz_front.min.css?ver=0.28' type='text/css' media='all' />
<link rel='stylesheet' id='learndash_style-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/assets/css/style.css?ver=2.1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='sfwd_front_css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/assets/css/front.css?ver=2.1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='jquery-dropdown-css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/assets/css/jquery.dropdown.min.css?ver=2.1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='sfwd_template_css-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/templates/learndash_template_style.css?ver=2.1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='badgeos-single-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/badgeos/css/badgeos-single.css?ver=1.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='x-stack-css'  href='https://gurus.pyimagesearch.com/wp-content/themes/x/framework/css/dist/site/stacks/renew.css?ver=4.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='x-child-css'  href='https://gurus.pyimagesearch.com/wp-content/themes/x-child/style.css?ver=4.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='x-google-fonts-css'  href='//fonts.googleapis.com/css?family=Lato%3A300%2C300italic%2C700%2C700italic%2C900%7CPacifico%3A400&#038;subset=latin%2Clatin-ext&#038;ver=4.3.4' type='text/css' media='all' />
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var usernoiseButton = {"text":"Feedback","style":"background-color: #169FE6; color: #FFFFFF","class":"un-right","windowUrl":"\/wp-admin\/admin-ajax.php?action=un_load_window","showButton":"1","disableOnMobiles":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/js/usernoise.js?ver=3.7.20'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/js/button.js?ver=3.7.20'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/gurus.pyimagesearch.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/js/remodal.min.js?ver=4.4.2'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/js/jquery-dateFormat.min.js?ver=4.4.2'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/pyimg-tour/js/gurus_sample_lesson.js?ver=4.4.2'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/themes/x/framework/js/dist/site/x-head.min.js?ver=4.3.4'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/x-shortcodes/js/dist/site/x-shortcodes-head.min.js?ver=3.0.5'></script>
<link rel='https://api.w.org/' href='https://gurus.pyimagesearch.com/wp-json/' />
<link rel="canonical" href="https://gurus.pyimagesearch.com/lesson-sample-segmenting-characters-from-license-plates/" />
<link rel='shortlink' href='https://gurus.pyimagesearch.com/?p=4036' />
<link rel="alternate" type="application/json+oembed" href="https://gurus.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fgurus.pyimagesearch.com%2Flesson-sample-segmenting-characters-from-license-plates%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://gurus.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fgurus.pyimagesearch.com%2Flesson-sample-segmenting-characters-from-license-plates%2F&#038;format=xml" />
<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
<style id="x-generated-css" type="text/css">a,h1 a:hover,h2 a:hover,h3 a:hover,h4 a:hover,h5 a:hover,h6 a:hover,.x-comment-time:hover,#reply-title small a,.comment-reply-link:hover,.x-comment-author a:hover,.x-recent-posts a:hover .h-recent-posts{color:#169fe6;}a:hover,#reply-title small a:hover{color:#169fe6;}.entry-title:before{color:#f1ba63;}a.x-img-thumbnail:hover,li.bypostauthor > article.comment{border-color:#169fe6;}.flex-direction-nav a,.flex-control-nav a:hover,.flex-control-nav a.flex-active,.x-dropcap,.x-skill-bar .bar,.x-pricing-column.featured h2,.h-comments-title small,.x-pagination a:hover,.x-entry-share .x-share:hover,.entry-thumb,.widget_tag_cloud .tagcloud a:hover,.widget_product_tag_cloud .tagcloud a:hover,.x-highlight,.x-recent-posts .x-recent-posts-img:after,.x-portfolio-filters{background-color:#169fe6;}.x-portfolio-filters:hover{background-color:#169fe6;}.x-main{width:68.79803%;}.x-sidebar{width:24.79803%;}.x-topbar .p-info,.x-topbar .p-info a,.x-topbar .x-social-global a{color:#ffffff;}.x-topbar .p-info a:hover{color:#959baf;}.x-topbar{background-color:#1f2c39;}.x-navbar .desktop .x-nav > li:before{padding-top:35px;}.x-navbar .desktop .x-nav > li > a,.x-navbar .desktop .sub-menu li > a,.x-navbar .mobile .x-nav li a{color:#ffffff;}.x-navbar .desktop .x-nav > li > a:hover,.x-navbar .desktop .x-nav > .x-active > a,.x-navbar .desktop .x-nav > .current-menu-item > a,.x-navbar .desktop .sub-menu li > a:hover,.x-navbar .desktop .sub-menu li.x-active > a,.x-navbar .desktop .sub-menu li.current-menu-item > a,.x-navbar .desktop .x-nav .x-megamenu > .sub-menu > li > a,.x-navbar .mobile .x-nav li > a:hover,.x-navbar .mobile .x-nav li.x-active > a,.x-navbar .mobile .x-nav li.current-menu-item > a{color:#ffffff;}.x-btn-navbar,.x-btn-navbar:hover{color:#ffffff;}.x-navbar .desktop .sub-menu li:before,.x-navbar .desktop .sub-menu li:after{background-color:#ffffff;}.x-navbar,.x-navbar .sub-menu{background-color:#169fe6 !important;}.x-btn-navbar,.x-btn-navbar.collapsed:hover{background-color:#666666;}.x-btn-navbar.collapsed{background-color:#444444;}.x-navbar .desktop .x-nav > li > a:hover > span,.x-navbar .desktop .x-nav > li.x-active > a > span,.x-navbar .desktop .x-nav > li.current-menu-item > a > span{box-shadow:0 2px 0 0 #ffffff;}.x-navbar .desktop .x-nav > li > a{height:90px;padding-top:35px;}.x-navbar .desktop .x-nav > li ul{top:90px;}.x-colophon.bottom{background-color:#ffffff;}.x-colophon.bottom,.x-colophon.bottom a,.x-colophon.bottom .x-social-global a{color:#a1a1a1;}.h-landmark{font-weight:300;}.x-comment-author a{color:#414141;}.x-comment-author a,.comment-form-author label,.comment-form-email label,.comment-form-url label,.comment-form-rating label,.comment-form-comment label,.widget_calendar #wp-calendar caption,.widget_calendar #wp-calendar th,.x-accordion-heading .x-accordion-toggle,.x-nav-tabs > li > a:hover,.x-nav-tabs > .active > a,.x-nav-tabs > .active > a:hover{color:#414141;}.widget_calendar #wp-calendar th{border-bottom-color:#414141;}.x-pagination span.current,.x-portfolio-filters-menu,.widget_tag_cloud .tagcloud a,.h-feature-headline span i,.widget_price_filter .ui-slider .ui-slider-handle{background-color:#414141;}@media (max-width:979px){}body{font-size:12px;font-style:normal;font-weight:300;color:#414141;background-color:#ffffff;}a:focus,select:focus,input[type="file"]:focus,input[type="radio"]:focus,input[type="submit"]:focus,input[type="checkbox"]:focus{outline:thin dotted #333;outline:5px auto #169fe6;outline-offset:-1px;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-family:"Lato",sans-serif;font-style:normal;font-weight:900;}h1,.h1{letter-spacing:-0.018em;}h2,.h2{letter-spacing:-0.025em;}h3,.h3{letter-spacing:-0.031em;}h4,.h4{letter-spacing:-0.042em;}h5,.h5{letter-spacing:-0.048em;}h6,.h6{letter-spacing:-0.071em;}.w-h{font-weight:900 !important;}.x-container.width{width:90%;}.x-container.max{max-width:1220px;}.x-main.full{float:none;display:block;width:auto;}@media (max-width:979px){.x-main.full,.x-main.left,.x-main.right,.x-sidebar.left,.x-sidebar.right{float:none;display:block;width:auto !important;}}.entry-header,.entry-content{font-size:16px;}body,input,button,select,textarea{font-family:"Lato",sans-serif;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,h1 a,h2 a,h3 a,h4 a,h5 a,h6 a,.h1 a,.h2 a,.h3 a,.h4 a,.h5 a,.h6 a,blockquote{color:#414141;}.cfc-h-tx{color:#414141 !important;}.cfc-h-bd{border-color:#414141 !important;}.cfc-h-bg{background-color:#414141 !important;}.cfc-b-tx{color:#414141 !important;}.cfc-b-bd{border-color:#414141 !important;}.cfc-b-bg{background-color:#414141 !important;}.x-navbar-inner{min-height:90px;}.x-brand{margin-top:20px;font-family:"Pacifico",cursive;font-size:44px;font-style:normal;font-weight:400;letter-spacing:-0.068em;color:#444444;}.x-brand:hover,.x-brand:focus{color:#444444;}.x-navbar .x-nav-wrap .x-nav > li > a{font-family:"Lato",sans-serif;font-style:normal;font-weight:700;letter-spacing:0.071em;text-transform:uppercase;}.x-navbar .desktop .x-nav > li > a{font-size:14px;}.x-navbar .desktop .x-nav > li > a:not(.x-btn-navbar-woocommerce){padding-left:14px;padding-right:14px;}.x-navbar .desktop .x-nav > li > a > span{margin-right:-0.071em;}.x-btn-navbar{margin-top:20px;}.x-btn-navbar,.x-btn-navbar.collapsed{font-size:22px;}@media (max-width:979px){.x-widgetbar{left:0;right:0;}}.x-btn,.button,[type="submit"]{color:#ffffff;border-color:#7fbf2a;background-color:#7fbf2a;margin-bottom:0.25em;text-shadow:0 0.075em 0.075em rgba(0,0,0,0.5);box-shadow:0 0.25em 0 0 #5f9f0a,0 4px 9px rgba(0,0,0,0.75);border-radius:0.25em;padding:0.579em 1.105em 0.842em;font-size:19px;}.x-btn:hover,.button:hover,[type="submit"]:hover{color:#fff;border-color:#7fbf2a;background-color:#7fbf2a;margin-bottom:0.25em;text-shadow:0 0.075em 0.075em rgba(0,0,0,0.5);box-shadow:0 0.25em 0 0 #5f9f0a,0 4px 9px rgba(0,0,0,0.75);}.x-btn.x-btn-real,.x-btn.x-btn-real:hover{margin-bottom:0.25em;text-shadow:0 0.075em 0.075em rgba(0,0,0,0.65);}.x-btn.x-btn-real{box-shadow:0 0.25em 0 0 #5f9f0a,0 4px 9px rgba(0,0,0,0.75);}.x-btn.x-btn-real:hover{box-shadow:0 0.25em 0 0 #5f9f0a,0 4px 9px rgba(0,0,0,0.75);}.x-btn.x-btn-flat,.x-btn.x-btn-flat:hover{margin-bottom:0;text-shadow:0 0.075em 0.075em rgba(0,0,0,0.65);box-shadow:none;}.x-btn.x-btn-transparent,.x-btn.x-btn-transparent:hover{margin-bottom:0;border-width:3px;text-shadow:none;text-transform:uppercase;background-color:transparent;box-shadow:none;}/* Adjust the color of paragraph blocks*/
article p{color: #212121;}

/* Adjust the link hover actions */
a:hover{text-decoration: underline;}

/* Make the logo fit in the header properly and add a border to the bottom of the header */
a.x-brand img {margin-top: -15px;}
header.masthead.masthead-inline{border-top: 5px solid #068fd6; border-bottom: 1px solid #068fd6}

/* Adjust post header sizes */
article.post header.entry-header h1.entry-title{font-size: 250%;}
article.post .entry-content.content h1{font-size: 200%;}
article.post .entry-content.content h2{font-size: 142.85%;}
article.post .entry-content.content h3{font-size: 114.25%;}
article.post .entry-content.content h4{font-size: 85.7%;}
article.post .entry-content.content h5{font-size: 75%;}
article.post .entry-content.content h6{font-size: 50%;}
article.post header.entry-header h1.entry-title, article.sfwd-lessons header.entry-header h1.entry-title, article.sfwd-topic header.entry-header h1.entry-title{font-size: 250%;}

/* Adjust the course in post headers */
article.sfwd-lessons .learndash.user_has_access h1, article.sfwd-topic .learndash.user_has_access h1, article.page h1{font-size: 200%;}
article.sfwd-lessons .learndash.user_has_access h2, article.sfwd-topic .learndash.user_has_access h2, article.page h2{font-size: 142.85%;}
article.sfwd-lessons .learndash.user_has_access h3, article.sfwd-topic .learndash.user_has_access h3, article.page h3{font-size: 114.25%;}
article.sfwd-lessons .learndash.user_has_access h4, article.sfwd-topic .learndash.user_has_access h4, article.page h4{font-size: 85.7%;}
article.sfwd-lessons .learndash.user_has_access h5, article.sfwd-topic .learndash.user_has_access h5, article.page h5{font-size: 75%;}
article.sfwd-lessons .learndash.user_has_access h6, article.sfwd-topic.learndash.user_has_access h6, article.page h6{font-size: 50%;}
article.post header.entry-header h1.entry-title{font-size: 250%;}

/* Make the post icon the standard blue */
h1.entry-title::before, h2.entry-title::before{color: #169fe6}

/* Hide the author attribution section and the tags section */
article.post p.p-meta, article.post footer.entry-footer.cf{display: none;}
article.sfwd-lessons header.entry-header p.p-meta{display: none;}
article.sfwd-topic header.entry-header p.p-meta{display: none;}
article.sfwd-courses header.entry-header{display: none;}
article.sfwd-courses footer.entry-footer.cf{display: none;}
article.sfwd-topic footer.entry-footer.cf{display: none;}
article.page footer.entry-footer.cf{display: none;}

/* Format quizzes */
article.sfwd-quiz header.entry-header{display: none;}
article.sfwd-quiz footer.entry-footer{display: none;}
article.sfwd-quiz .wpProQuiz_content h2{margin-top: 0px;}

/* Course table updates */
article.sfwd-courses #learndash_lessons a{font-weight: bold;}
article.sfwd-courses .notavailable_message{font-size: 13px; font-family: "Helvetica Neue",Helvetica,sans-serif; color: #717171;}

/* Hide the post header section from unauthorized access */
article.category-uncategorized header.entry-header{display: none;}
article.category-uncategorized .mepr-unauthorized-message h4{margin-top: 0px;}
article.sfwd-lessons footer.entry-footer.cf{display: none;}

/* Fix the header on the login and authorized page */
article#post-6 h4{font-size: 142.85%;}

/* Adjust the size of the login form inputs */
input#user_login, input#user_pass{width: 60%;}

/* Adjust the widths of input fields on the registration form */
#mepr_registerform input[type=text], input[type=password]{width: 35%;}

/* Hide the header breadcrumb certain pages */
.postid-28 header.x-header-landmark, .postid-3148 header.x-header-landmark, .postid-91 header.x-header-landmark, .postid-95 header.x-header-landmark, .postid-92 header.x-header-landmark, .postid-97 header.x-header-landmark, .postid-98 header.x-header-landmark, .postid-93 header.x-header-landmark, .postid-96 header.x-header-landmark, .postid-99 header.x-header-landmark, .postid-94 header.x-header-landmark, .postid-100 header.x-header-landmark, .page-id-6 header.x-header-landmark{display: none;}

/* Adjust letter spacing on lesson not available spacing */
small.notavailable_message{letter-spacing: -0.5px;}

/* Extra padding for full line Latex equations */
div.latex_equation_line{margin-bottom: 1.5em;}

.page-id-4042 #top, .page-id-4044 #top, .page-id-4036 #top, .page-id-4103 #top, .page-id-4101 #top{background: url('https://gurus.pyimagesearch.com/wp-content/uploads/2015/10/sample_lesson.png') 0px 0px repeat;}

/* BadgeOS Notification styles */
#TB_ajaxContent{width: 640px !important;}
#TB_title{color: #FFFFFF;}
#badgeos_congrats .badgeos-congrats-achievement{padding: 10px; padding-left: 15px;}
#badgeos_congrats .badgeos-congrats-achievement p.title{margin-bottom: 10px;}
#badgeos_congrats .badgeos-congrats-achievement .content{margin-top: 10px;}
#badgeos_congrats .badgeos-congrats-achievement .content p{margin: 0px; padding: 0px; font-size: 16px; line-height: 22px;}
#badgeos_congrats .badgeos-congrats-achievement .content .course_progress{margin-left: 0px;}

/* User achievements page */
article.user-has-earned header.entry-header p.p-meta, article.user-has-not-earned header.entry-header p.p-meta{display: none;}
article.user-has-earned .entry-featured, article.user-has-not-earned .entry-featured{display: none;}
article.user-has-earned .badgeos-achievement-congratulations, article.user-has-not-earned .badgeos-achievement-congratulations{display: none;}

/* Hide breadcrumb on Certificates page */
body.page-id-10138 .x-header-landmark{display: none;}</style></head>

<body class="page page-id-4036 page-template-default x-renew x-navbar-static-active x-full-width-layout-active x-content-sidebar-active x-v4_3_4 x-child-theme-active x-shortcodes-v3_0_5">


  <div id="top" class="site">



  <header class="masthead masthead-inline" role="banner">



  <div class="x-navbar-wrap">
    <div class="x-navbar">
      <div class="x-navbar-inner">
        <div class="x-container max width">


<a href="https://gurus.pyimagesearch.com/" class="x-brand img" title="A course and community designed to take you from computer vision beginner to guru.">
  <img src="//gurus.pyimagesearch.com/wp-content/uploads/2015/03/pyimagesearch_gurus_logo.png" alt="A course and community designed to take you from computer vision beginner to guru."></a>
<a href="#" class="x-btn-navbar collapsed" data-toggle="collapse" data-target=".x-nav-wrap.mobile">
  <i class="x-icon-bars" data-x-icon="&#xf0c9;"></i>
  <span class="visually-hidden">Navigation</span>
</a>

<nav class="x-nav-wrap desktop" role="navigation">
  <ul id="menu-main-menu" class="x-nav"><li id="menu-item-16" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16"><a href="https://gurus.pyimagesearch.com/"><span>Login</span></a></li>
<li id="menu-item-52" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52"><a href="http://community.pyimagesearch.com/"><span>Community</span></a></li>
</ul></nav>

<div class="x-nav-wrap mobile collapse">
  <ul id="menu-main-menu-1" class="x-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16"><a href="https://gurus.pyimagesearch.com/"><span>Login</span></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52"><a href="http://community.pyimagesearch.com/"><span>Community</span></a></li>
</ul></div>        </div>
      </div>
    </div>
  </div>

  </header>



    <header class="x-header-landmark">
      <div class="x-container max width">
        <div class="x-landmark-breadcrumbs-wrap">
          <div class="x-landmark">


            <h1 class="h-landmark entry-title"><span>Segmenting characters from license plates</span></h1>


          </div>

                                    <div class="x-breadcrumbs-wrap">
                <div class="x-breadcrumbs"><a href="https://gurus.pyimagesearch.com"><span class="home"><i class="x-icon-home" data-x-icon="&#xf015;"></i></span></a> <span class="delimiter"><i class="x-icon-angle-right" data-x-icon="&#xf105;"></i></span> <span class="current">Segmenting characters from license plates</span></div>              </div>


        </div>
      </div>
    </header>


  <div class="x-container max width offset">
    <div class="x-main left" role="main">


<article id="post-4036" class="post-4036 page type-page status-publish hentry user-has-not-earned no-post-thumbnail">
  <div class="entry-wrap">



<div class="entry-content content">


  <p><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg"><img class="aligncenter wp-image-3014" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg" alt="Figure 12: Our ANPR pipeline once again able to locate the license plate region in the image and segment the foreground characters from the background license plate." width="800" height="500" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-300x188.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-1024x640.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-865x541.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-1204x753.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg 1500w" sizes="(max-width: 800px) 100vw, 800px" /></a></p>
<p>In our previous lesson, we learned how to <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">localize license plates in images</a></strong> using basic image processing techniques, such as morphological operations and contours. These license plate regions are called <em>license plate </em><i>candidates</i> &#8212; it is our job to take these candidate regions and start the task of extracting the <em>foreground license plate characters</em> from the <em>background of the license plate</em>.</p>
<p>On the surface, this step looks quite easy &#8212; all we need to do is perform basic thresholding, and we&#8217;ll be able to extract the license plate characters, right?</p>
<p>Well, not exactly.</p>
<p>Sure, if we apply basic thresholding, we&#8217;ll be able to extract the license plate characters &#8212; but we&#8217;ll also extract a bunch of other &#8220;stuff&#8221; that doesn&#8217;t interest us, such as any bolts fastening the license plate to the car, branding logos on the plate itself, or embellishments on the license plate frames. All three of these aspects can cause problems for our character segmentation algorithm, so we&#8217;ll need to take special care as we write our code.</p>
<p>But no worries &#8212; I&#8217;ve got you covered. While there are a few &#8220;gotchas&#8221; that may trip you up, once you see them first hand, I think you&#8217;ll be able to spot them in the future when you work on your own projects.</p>
<h1>Objectives:</h1>
<p>In this lesson, we will:</p>
<ul>
<li>Apply a <em>perspective transform</em> to extract the license plate region from the car, obtaining a top-down, bird&#8217;s eye view more suitable for character segmentation.</li>
<li>Perform a <em>connected component analysis</em> on the license plate region to find character-like sections of the image.</li>
<li>Utilize <em>contour properties</em> to aide us in segmenting the <em>foreground license plate characters</em> from the <em>background of the license plate.</em></li>
</ul>
<h1>Segmenting characters from the license plate</h1>
<p>As a quick refresher from our previous lesson on <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">license plate localization</a></strong>, our algorithm is now capable of identifying license plate-like regions in our dataset of images:</p>
<div id="attachment_2432" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful.jpg"><img class="wp-image-2432" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful.jpg" alt="Figure 1: Examples of detecting license plate-like regions in images." width="800" height="617" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful-300x231.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful-100x77.jpg 100w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful-865x667.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_localize_successful.jpg 1022w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 1:</strong> Examples of detecting license plate-like regions in images.</p></div>
<p>In each of the images above, you can see that we have clearly found the license plate in the image and drawn a green bounding box surrounding it.</p>
<p>The next step is for us to take this license plate region and apply image processing and computer vision techniques to <i>segment</i> the license plate characters from the license plate itself.</p>
<h2>Character segmentation</h2>
<p>In order to perform character segmentation, we&#8217;ll need to heavily modify our
			<span id="crayon-5827628cddd93687839420" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">license_plate</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  file from the previous lesson. This file encapsulates all the methods we need to extract license plates and license plate characters from images. The
			<span id="crayon-5827628cddda3404247456" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlateDetector</span></span></span>  class specifically will be doing a lot of the heavy lifting for us. Here&#8217;s a quick breakdown of the structure of the
			<span id="crayon-5827628cddda7574778697" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlateDetector</span></span></span>  class:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdddaa440461882" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">LicensePlateDetector class structure</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
|--- LicensePlateDetector
|    |--- __init__
|    |--- detect
|    |--- detectPlates
|    |--- detectCharacterCandidates</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdddaa440461882-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddaa440461882-2">2</div><div class="crayon-num" data-line="crayon-5827628cdddaa440461882-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddaa440461882-4">4</div><div class="crayon-num" data-line="crayon-5827628cdddaa440461882-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdddaa440461882-1"><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">LicensePlateDetector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddaa440461882-2"><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">__init__</span></div><div class="crayon-line" id="crayon-5827628cdddaa440461882-3"><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">detect</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddaa440461882-4"><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">detectPlates</span></div><div class="crayon-line" id="crayon-5827628cdddaa440461882-5"><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">detectCharacterCandidates</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>
We&#8217;ve already started to define this class in our previous lesson. The
			<span id="crayon-5827628cdddad578302094" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">__init__</span></span></span>  method is simply our constructor. The
			<span id="crayon-5827628cdddb0766613207" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detect</span></span></span>  method calls all necessary sub-methods to perform the license plate detection. The aptly named
			<span id="crayon-5827628cdddb2853561850" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span>  function accepts an image and detects all license plate candidates. Finally, the
			<span id="crayon-5827628cdddb5182992370" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCandidates</span></span></span>  method is used to accept a license plate region and segment the license plate characters from the background.</p>
<p>The
			<span id="crayon-5827628cdddb8444870354" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span>  function is already 100% defined from our previous lesson, so we aren&#8217;t going to focus on that method. However, we will need to modify the constructor to modify a few arguments, update the
			<span id="crayon-5827628cdddba035923630" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detect</span></span></span>  method to return the character candidates, and define the entire
			<span id="crayon-5827628cdddbe493239470" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCandidates</span></span></span>  function.</p>
<p>Since we&#8217;ll be building on our previous lesson and introducing a lot of new functionality, let&#8217;s just start from the top of
			<span id="crayon-5827628cdddc0075280428" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">license_plate</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  and start reworking our code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdddc3708268426" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-2">2</div><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-4">4</div><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-6">6</div><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-8">8</div><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-10">10</div><div class="crayon-num" data-line="crayon-5827628cdddc3708268426-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddc3708268426-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdddc3708268426-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">collections</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">namedtuple</span></div><div class="crayon-line" id="crayon-5827628cdddc3708268426-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">skimage</span><span class="crayon-sy">.</span><span class="crayon-k ">filter</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">threshold_adaptive</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">skimage </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">segmentation</span></div><div class="crayon-line" id="crayon-5827628cdddc3708268426-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">skimage </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">measure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-6"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">imutils </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">perspective</span></div><div class="crayon-line" id="crayon-5827628cdddc3708268426-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line" id="crayon-5827628cdddc3708268426-9"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-10">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdddc3708268426-11"><span class="crayon-c"># define the named tupled to store the license plate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddc3708268426-12"><span class="crayon-v">LicensePlate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">namedtuple</span><span class="crayon-sy">(</span><span class="crayon-s">"LicensePlateRegion"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"success"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"plate"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"thresh"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"candidates"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>
The first thing you&#8217;ll notice is that we&#8217;re importing a lot more packages than from our previous lesson, mainly image processing functions from scikit-image and
			<span id="crayon-5827628cdddc6580514438" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imutils</span></span></span> .</p>
<p>We also define a
			<span id="crayon-5827628cdddc8125842962" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  on <strong>Line 12</strong> which is used to store information regarding the detected license plate. If you have never heard of (or used) a
			<span id="crayon-5827628cdddcb591321927" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  before, no worries &#8212; they are simply easy-to-create, lightweight object types. If you are familiar with the C/C++ programming language, you may remember the keyword
			<span id="crayon-5827628cdddcd071161162" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-k ">struct</span></span></span>  which is a way of defining a complex data type.</p>
<p>The
			<span id="crayon-5827628cdddd0531774238" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  functionality in Python is quite similar to a
			<span id="crayon-5827628cdddd2543904774" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-k ">struct</span></span></span>  in C. You start by creating a namespace for the tuple, in this case
			<span id="crayon-5827628cdddd4762634453" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlateRegion</span></span></span> , followed by a list of attributes that the
			<span id="crayon-5827628cdddd7192813594" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  has. Since the Python language is loosely typed, there is no need to define the data types of each of the attributes. In many ways, you can mimic the functionality of a
			<span id="crayon-5827628cdddd9055640896" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  using other built-in Python datatypes, such as dictionaries and lists; however, the
			<span id="crayon-5827628cddddc371334860" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  gives you a big distinct advantage &#8212; it&#8217;s dead simple to instantiate new
			<span id="crayon-5827628cdddde132756554" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuples</span></span></span> . In fact, as you&#8217;ll see later in this lesson, it&#8217;s as simple as passing in a list of arguments to the
			<span id="crayon-5827628cddde1805806618" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>  variable, just like instantiating a class!</p>
<p>In the meantime, the descriptions of each
			<span id="crayon-5827628cddde3766376888" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>  attribute are listed below:</p>
<ul>
<li>
			<span id="crayon-5827628cddde5481905215" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">success</span></span></span> : A boolean indicating whether the license plate detection and character segmentation was successful or not.</li>
<li>
			<span id="crayon-5827628cddde8317170969" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">plate</span></span></span> : An image of the detected license plate.</li>
<li>
			<span id="crayon-5827628cdddea603530695" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">thresh</span></span></span> : The thresholded license plate region, revealing the license plate characters on the background.</li>
<li>
			<span id="crayon-5827628cddded199186118" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">candidates</span></span></span> : A list of character candidates that should be passed on to our machine learning classifier for final identification.</li>
</ul>
<p>We&#8217;ll be discussing each of these attributes in more detail as we work through the rest of this lesson, but it&#8217;s a good idea to have a high-level understanding of what we&#8217;re going to use our
			<span id="crayon-5827628cdddef651996647" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>
			<span id="crayon-5827628cdddf1914870939" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span>  for.</p>
<p>Let&#8217;s move on to our constructor:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdddf4294073287" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddf4294073287-14">14</div><div class="crayon-num" data-line="crayon-5827628cdddf4294073287-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddf4294073287-16">16</div><div class="crayon-num" data-line="crayon-5827628cdddf4294073287-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddf4294073287-18">18</div><div class="crayon-num" data-line="crayon-5827628cdddf4294073287-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddf4294073287-20">20</div><div class="crayon-num" data-line="crayon-5827628cdddf4294073287-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdddf4294073287-22">22</div><div class="crayon-num" data-line="crayon-5827628cdddf4294073287-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddf4294073287-14"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-v">LicensePlateDetector</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5827628cdddf4294073287-15"><span class="crayon-h">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minPlateW</span><span class="crayon-o">=</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minPlateH</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numChars</span><span class="crayon-o">=</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minCharW</span><span class="crayon-o">=</span><span class="crayon-cn">40</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddf4294073287-16"><span class="crayon-h">		</span><span class="crayon-c"># store the image to detect license plates in, the minimum width and height of the</span></div><div class="crayon-line" id="crayon-5827628cdddf4294073287-17"><span class="crayon-h">		</span><span class="crayon-c"># license plate region, the number of characters to be detected in the license plate,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddf4294073287-18"><span class="crayon-h">		</span><span class="crayon-c"># and the minimum width of the extracted characters</span></div><div class="crayon-line" id="crayon-5827628cdddf4294073287-19"><span class="crayon-h">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddf4294073287-20"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">minPlateW</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">minPlateW</span></div><div class="crayon-line" id="crayon-5827628cdddf4294073287-21"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">minPlateH</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">minPlateH</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdddf4294073287-22"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">numChars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">numChars</span></div><div class="crayon-line" id="crayon-5827628cdddf4294073287-23"><span class="crayon-e">		</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">minCharW</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">minCharW</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>
Not a whole lot has changed with our constructor, except that we are now accepting two more parameters:
			<span id="crayon-5827628cdddf7592969358" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">numChars</span></span></span> , which is the number of characters our license plate has, and
			<span id="crayon-5827628cdddf9057023981" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">minCharW</span></span></span> , which, as the name suggests, is the minimum number of pixels wide a region must be to be considered a license plate character.</p>
<p>You might be thinking, isn&#8217;t it cheating to supply a value like
			<span id="crayon-5827628cdddfc420522737" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">numChars</span></span></span>  to our
			<span id="crayon-5827628cdddfe410020135" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlateDetector</span></span></span> ? How do we <em>know</em> that the license plate we have detected contains seven characters? Couldn&#8217;t it just as easily contain five characters? Or ten?</p>
<p>Well, as I mentioned in our <strong><a href="https://gurus.pyimagesearch.com/lessons/what-is-anpr/">What is ANPR?</a></strong> lesson (and is true for all computer vision projects, even ones unrelated to ANPR), we need to apply as much <em>a priori</em> knowledge as we possibly can to build a successful system. After examining our dataset in the previous two lessons, a clear piece of knowledge we can exploit is the number of characters present on the license plate:</p>
<div id="attachment_3003" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_7_chars_example.jpg"><img class="wp-image-3003" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_7_chars_example.jpg" alt="Figure 2: An important fact to note is that each of our license plates contains 7 characters -- 3 letters followed by 4 numbers. We'll be able to exploit this information to build a more accurate character classifier later in this module." width="800" height="446" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_7_chars_example-300x167.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_7_chars_example.jpg 858w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 2:</strong> An important fact to note is that each of our license plates contains 7 characters &#8212; 3 letters followed by 4 numbers. We&#8217;ll be able to exploit this information to build a more accurate character classifier later in this module.</p></div>
<p>In each of the above cases, all license plates contain seven characters. Thus, if we are to build an ANPR system for this region of the world, we can safely assume a license plate has seven characters. If a license plate <em>does not</em> contain seven characters, then we can flag the plate and manually investigate it to see (1) if there is a bug in our ANPR system, or (2) we need to create a separate ANPR system to recognize plates with a different number of characters. Remember from our <strong><a href="https://gurus.pyimagesearch.com/lessons/what-is-anpr/">introductory lesson</a></strong>, ANPR systems are <em>highly tuned</em> to the regions of the world they are deployed to &#8212; thus it is safe (and even presumable) for us to apply these types of assumptions.</p>
<p>Our
			<span id="crayon-5827628cdde02490282239" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detect</span></span></span>  method will also require a few minor updates:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde05801514477" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde05801514477-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-26">26</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-28">28</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-30">30</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-32">32</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-34">34</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde05801514477-36">36</div><div class="crayon-num" data-line="crayon-5827628cdde05801514477-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde05801514477-25"><span class="crayon-e">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">detect</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-26"><span class="crayon-h">		</span><span class="crayon-c"># detect license plate regions in the image</span></div><div class="crayon-line" id="crayon-5827628cdde05801514477-27"><span class="crayon-h">		</span><span class="crayon-v">lpRegions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">detectPlates</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-28">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde05801514477-29"><span class="crayon-h">		</span><span class="crayon-c"># loop over the license plate regions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-30"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">lpRegion </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lpRegions</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5827628cdde05801514477-31"><span class="crayon-h">			</span><span class="crayon-c"># detect character candidates in the current license plate region</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-32"><span class="crayon-h">			</span><span class="crayon-v">lp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">detectCharacterCandidates</span><span class="crayon-sy">(</span><span class="crayon-v">lpRegion</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde05801514477-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-34"><span class="crayon-h">			</span><span class="crayon-c"># only continue if characters were successfully detected</span></div><div class="crayon-line" id="crayon-5827628cdde05801514477-35"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">lp</span><span class="crayon-sy">.</span><span class="crayon-v">success</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde05801514477-36"><span class="crayon-h">				</span><span class="crayon-c"># yield a tuple of the license plate object and bounding box</span></div><div class="crayon-line" id="crayon-5827628cdde05801514477-37"><span class="crayon-h">				</span><span class="crayon-r">yield</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">lp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lpRegion</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0097 seconds] -->
<p>
The changes here are quite self-explanatory. A call is made to
			<span id="crayon-5827628cdde08762386178" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span>  to find the license plate regions in the image. We loop over each of these license plate regions individually, make a call to the
			<span id="crayon-5827628cdde0b378214478" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCanidates</span></span></span>  method (to be defined in a few short sentences), to detect the characters on the license plate region itself, and finally, return a tuple of the
			<span id="crayon-5827628cdde14699370644" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>  object and license plate bounding box to the calling function.</p>
<p>The
			<span id="crayon-5827628cdde17322955937" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span>  function is defined next, but since we have already reviewed in our <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">license plate localization lesson</a></strong>, we&#8217;ll skip it in this article &#8212; please refer that lesson for the definition of
			<span id="crayon-5827628cdde19582712382" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span> . As the name suggests, it simply detects license plate candidates in an input image.</p>
<p>It&#8217;s clear that all the real work is done inside the
			<span id="crayon-5827628cdde1c586407843" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCandidates</span></span></span>  function. This method accepts a license plate region, applies image processing techniques, and then segments the foreground license plate characters from the background. Let&#8217;s go ahead and start defining this method:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde1e061469038" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde1e061469038-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde1e061469038-100">100</div><div class="crayon-num" data-line="crayon-5827628cdde1e061469038-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde1e061469038-102">102</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde1e061469038-99"><span class="crayon-e">	</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">detectCharacterCandidates</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">region</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde1e061469038-100"><span class="crayon-h">		</span><span class="crayon-c"># apply a 4-point transform to extract the license plate</span></div><div class="crayon-line" id="crayon-5827628cdde1e061469038-101"><span class="crayon-h">		</span><span class="crayon-v">plate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">perspective</span><span class="crayon-sy">.</span><span class="crayon-e">four_point_transform</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">region</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde1e061469038-102"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Perspective Transform"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">plate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0251 seconds] -->
<p>
The
			<span id="crayon-5827628cdde23729246992" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCandidates</span></span></span>  method accepts only a single parameter &#8212; the
			<span id="crayon-5827628cdde26156633728" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">region</span></span></span>  of the image that contains the license plate candidate. We know from our definition of
			<span id="crayon-5827628cdde28912037175" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectPlates</span></span></span>  that the
			<span id="crayon-5827628cdde2b566605344" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">region</span></span></span>  is a rotated bounding box:</p>
<p>Figure 3: Our license plate detection method returns a rotated bounding box corresponding to the location of the license plate in the image.</p>
<div id="attachment_3005" style="width: 610px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate.jpg"><img class="wp-image-3005" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate.jpg" alt="Figure 3: Our license plate detection method returns a rotated bounding box corresponding to the location of the license plate in the image." width="600" height="490" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate-300x245.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate-1024x837.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate-865x707.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate-1204x984.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_original_plate.jpg 1508w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 3:</strong> Our license plate detection method returns a rotated bounding box corresponding to the location of the license plate in the image.</p></div>
<p>However, looking at this license plate region, we can see that it is a bit distorted and skewed. This skewness can dramatically throw off not only our <em>character segmentation</em> algorithms, but also <em>character identification</em> algorithms when it comes to applying machine learning later in this module.</p>
<p>Because of this, we must first apply a <strong><a href="http://www.pyimagesearch.com/2014/08/25/4-point-opencv-getperspective-transform-example/" target="_blank">perspective transform</a></strong> to apply a top-down, bird&#8217;s eye view of the license plate:</p>
<div id="attachment_3006" style="width: 610px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_perspective_transform.jpg"><img class="wp-image-3006" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_perspective_transform.jpg" alt="Figure 4: The original license plate could be distorted or skewed which can hurt character classification performance later in the ANPR pipeline. We apply a perspective transform to obtain a top-down, 90 degree viewing angle of the license plate to help alleviate this problem." width="600" height="268" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_perspective_transform-300x134.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_perspective_transform-865x387.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_perspective_transform.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 4:</strong> The original license plate could be distorted or skewed which can hurt character classification performance later in the ANPR pipeline. We apply a perspective transform to obtain a top-down, 90-degree viewing angle of the license plate to help alleviate this problem.</p></div>
<p>Notice how the perspective of the license plate has been adjusted, as if we had a 90-degree viewing angle, cleanly looking down on it.</p>
<p><b>Note:</b> I cover perspective transform twice on the PyImageSearch blog. The <strong><a href="http://www.pyimagesearch.com/2014/08/25/4-point-opencv-getperspective-transform-example/" target="_blank">first post</a></strong> covers the basics of performing a perspective transform, and the second post applies perspective transform to solve a real-world computer vision problem &#8212; <strong><a href="http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/" target="_blank">building a mobile document scanner</a></strong>. Once we get through the first round of this course, I plan on rewriting these perspective transform articles and bringing them inside <strong><a href="https://gurus.pyimagesearch.com/lessons/computer-vision-basics/" target="_blank">Module 1</a></strong> of PyImageSearch Gurus. But for the time being, I think the explanations on the blog clearly demonstrate how a perspective transformation works.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde2f032325776" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))

		# extract the Value component from the HSV color space and apply adaptive thresholding
		# to reveal the characters on the license plate
		V = cv2.split(cv2.cvtColor(plate, cv2.COLOR_BGR2HSV))[2]
		thresh = threshold_adaptive(V, 30, offset=15).astype("uint8") * 255
		thresh = cv2.bitwise_not(thresh)

		# resize the license plate region to a canonical size
		plate = imutils.resize(plate, width=400)
		thresh = imutils.resize(thresh, width=400)
		cv2.imshow("Thresh", thresh)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde2f032325776-104">104</div><div class="crayon-num" data-line="crayon-5827628cdde2f032325776-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde2f032325776-106">106</div><div class="crayon-num" data-line="crayon-5827628cdde2f032325776-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde2f032325776-108">108</div><div class="crayon-num" data-line="crayon-5827628cdde2f032325776-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde2f032325776-110">110</div><div class="crayon-num" data-line="crayon-5827628cdde2f032325776-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde2f032325776-112">112</div><div class="crayon-num" data-line="crayon-5827628cdde2f032325776-113">113</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde2f032325776-104"><span class="crayon-h">		</span><span class="crayon-c"># extract the Value component from the HSV color space and apply adaptive thresholding</span></div><div class="crayon-line" id="crayon-5827628cdde2f032325776-105"><span class="crayon-h">		</span><span class="crayon-c"># to reveal the characters on the license plate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde2f032325776-106"><span class="crayon-h">		</span><span class="crayon-v">V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">cvtColor</span><span class="crayon-sy">(</span><span class="crayon-v">plate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">COLOR_BGR2HSV</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5827628cdde2f032325776-107"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">threshold_adaptive</span><span class="crayon-sy">(</span><span class="crayon-v">V</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-o">=</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">255</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde2f032325776-108"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">bitwise_not</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde2f032325776-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde2f032325776-110"><span class="crayon-h">		</span><span class="crayon-c"># resize the license plate region to a canonical size</span></div><div class="crayon-line" id="crayon-5827628cdde2f032325776-111"><span class="crayon-h">		</span><span class="crayon-v">plate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">plate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde2f032325776-112"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde2f032325776-113"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Thresh"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thresh</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0207 seconds] -->
<p>
Now that we have a top-down, bird&#8217;s eye view of the license plate, we can start to process it. The first step is to extract the Value channel from the HSV color space on <strong>Line 106</strong>.</p>
<p>So why did I extract the Value channel rather than use the grayscale version of the image?</p>
<p>Well, if you remember back to our lesson on <strong><a href="https://gurus.pyimagesearch.com/lessons/lighting-and-color-spaces/" target="_blank">lighting and color spaces</a></strong>, you&#8217;ll recall that the grayscale version of an image is a <em>weighted combination</em> of the RGB channels. The Value channel, however, is given a dedicated dimension in the HSV color space. When performing thresholding to extract <em>dark regions</em> from a <em>light background</em> (or vice versa), better results can often be obtained by using the Value rather than grayscale.</p>
<p>To segment the license plate characters from the background, we apply <strong><a href="https://gurus.pyimagesearch.com/lessons/thresholding/" target="_blank">adaptive thresholding</a></strong> on <strong>Line 107</strong>, where thresholding is applied to each local <em>30 x 30</em> pixel region of the image. As we know from our <strong><a href="https://gurus.pyimagesearch.com/lessons/thresholding/">thresholding lesson</a></strong>, basic thresholding and Otsu&#8217;s thresholding both obtain sub-par results when segmenting license plate characters:</p>
<div id="attachment_3007" style="width: 610px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh.jpg"><img class="wp-image-3007" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh.jpg" alt="Figure 5: Applying Otsu’s thresholding method in an attempt to segment the foreground characters from the background license plate -- notice how the bolt of the license plate is connected to the 0 character. This can cause problems in character recognition later in our ANPR pipeline." width="600" height="264" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh-300x132.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh-100x44.jpg 100w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh-865x381.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_otsu_thresh.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 5:</strong> Applying Otsu’s thresholding method in an attempt to segment the foreground characters from the background license plate &#8212; notice how the bolt of the license plate is connected to the &#8220;0&#8221; character. This can cause problems in character recognition later in our ANPR pipeline.</p></div>
<p>At first glance, this output doesn’t look too bad. Each character appears to be neatly segmented from the background &#8212; except for that number <em>0</em> at the end. Notice how the bolt of the license plate is attached to the character. While this artifact doesn&#8217;t seem like a big deal, failing to extract high-quality segmented representations of each license plate character can really hurt our classification performance when we go to recognize each of the characters later in this module.</p>
<p>Due to the limitations of basic thresholding, we instead apply adaptive thresholding, which gives us much better results:</p>
<div id="attachment_3008" style="width: 610px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh.jpg"><img class="wp-image-3008" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh.jpg" alt="Figure 6: The result of applying adaptive threshold -- the gap between the bolt and the number 0 is clearly visible now." width="600" height="264" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh-300x132.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh-100x44.jpg 100w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh-865x381.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_adaptive_thresh.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 6:</strong> The result of applying adaptive threshold &#8212; the gap between the bolt and the number &#8220;0&#8221; is clearly visible now.</p></div>
<p>Notice how the bolt and the <em>0</em> character are cleanly detached from each other.</p>
<p>In previous lessons in this course, we often would apply contour detection after obtaining a binary representation of an image. However, in this case, we are going to do something a bit different &#8212; we&#8217;ll instead apply a <strong><a href="https://gurus.pyimagesearch.com/lessons/connected-component-labeling/">connected component analysis</a></strong> of the thresholded license plate region:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde37190917250" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))

		# extract the Value component from the HSV color space and apply adaptive thresholding
		# to reveal the characters on the license plate
		V = cv2.split(cv2.cvtColor(plate, cv2.COLOR_BGR2HSV))[2]
		thresh = threshold_adaptive(V, 30, offset=15).astype("uint8") * 255
		thresh = cv2.bitwise_not(thresh)

		# resize the license plate region to a canonical size
		plate = imutils.resize(plate, width=400)
		thresh = imutils.resize(thresh, width=400)
		cv2.imshow("Thresh", thresh)

		# perform a connected components analysis and initialize the mask to store the locations
		# of the character candidates
		labels = measure.label(thresh, neighbors=8, background=0)
		charCandidates = np.zeros(thresh.shape, dtype="uint8")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde37190917250-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde37190917250-116">116</div><div class="crayon-num" data-line="crayon-5827628cdde37190917250-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde37190917250-118">118</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde37190917250-115"><span class="crayon-h">		</span><span class="crayon-c"># perform a connected components analysis and initialize the mask to store the locations</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde37190917250-116"><span class="crayon-h">		</span><span class="crayon-c"># of the character candidates</span></div><div class="crayon-line" id="crayon-5827628cdde37190917250-117"><span class="crayon-h">		</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">measure</span><span class="crayon-sy">.</span><span class="crayon-e">label</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neighbors</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">background</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde37190917250-118"><span class="crayon-h">		</span><span class="crayon-v">charCandidates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0312 seconds] -->
<p>
Given our connected component labels, we initialize a
			<span id="crayon-5827628cdde3f726100479" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">charCandidates</span></span></span>  mask to hold the contours of the character candidates on <strong>Line 118</strong>.</p>
<p>Now that we have the labels for each connected component, let&#8217;s loop over them individually and process them:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde42335752225" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))

		# extract the Value component from the HSV color space and apply adaptive thresholding
		# to reveal the characters on the license plate
		V = cv2.split(cv2.cvtColor(plate, cv2.COLOR_BGR2HSV))[2]
		thresh = threshold_adaptive(V, 30, offset=15).astype("uint8") * 255
		thresh = cv2.bitwise_not(thresh)

		# resize the license plate region to a canonical size
		plate = imutils.resize(plate, width=400)
		thresh = imutils.resize(thresh, width=400)
		cv2.imshow("Thresh", thresh)

		# perform a connected components analysis and initialize the mask to store the locations
		# of the character candidates
		labels = measure.label(thresh, neighbors=8, background=0)
		charCandidates = np.zeros(thresh.shape, dtype="uint8")

		# loop over the unique components
		for label in np.unique(labels):
			# if this is the background label, ignore it
			if label == -1:
				continue

			# otherwise, construct the label mask to display only connected components for the
			# current label, then find contours in the label mask
			labelMask = np.zeros(thresh.shape, dtype="uint8")
			labelMask[labels == label] = 255
			(cnts, _) = cv2.findContours(labelMask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-120">120</div><div class="crayon-num" data-line="crayon-5827628cdde42335752225-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-122">122</div><div class="crayon-num" data-line="crayon-5827628cdde42335752225-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-124">124</div><div class="crayon-num" data-line="crayon-5827628cdde42335752225-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-126">126</div><div class="crayon-num" data-line="crayon-5827628cdde42335752225-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-128">128</div><div class="crayon-num" data-line="crayon-5827628cdde42335752225-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde42335752225-130">130</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-120"><span class="crayon-h">		</span><span class="crayon-c"># loop over the unique components</span></div><div class="crayon-line" id="crayon-5827628cdde42335752225-121"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">label </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">unique</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-122"><span class="crayon-h">			</span><span class="crayon-c"># if this is the background label, ignore it</span></div><div class="crayon-line" id="crayon-5827628cdde42335752225-123"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-124"><span class="crayon-h">				</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5827628cdde42335752225-125">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-126"><span class="crayon-h">			</span><span class="crayon-c"># otherwise, construct the label mask to display only connected components for the</span></div><div class="crayon-line" id="crayon-5827628cdde42335752225-127"><span class="crayon-h">			</span><span class="crayon-c"># current label, then find contours in the label mask</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-128"><span class="crayon-h">			</span><span class="crayon-v">labelMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">thresh</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde42335752225-129"><span class="crayon-h">			</span><span class="crayon-v">labelMask</span><span class="crayon-sy">[</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde42335752225-130"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">findContours</span><span class="crayon-sy">(</span><span class="crayon-v">labelMask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">RETR_EXTERNAL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">CHAIN_APPROX_SIMPLE</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0235 seconds] -->
<p>
We start looping over each of the
			<span id="crayon-5827628cdde48388474615" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labels</span></span></span>  on <strong>Line 121</strong>. If the
			<span id="crayon-5827628cdde4b085682228" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">label</span></span></span>  is <i>-1</i>, then we know the
			<span id="crayon-5827628cdde4d598524369" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">label</span></span></span>  corresponds to the background of the license plate, so we can safely ignore it.</p>
<p>Otherwise, we allocate memory for the
			<span id="crayon-5827628cdde50409283289" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labelMask</span></span></span>  on <strong>Line 128</strong> and draw all pixels with the current
			<span id="crayon-5827628cdde52485281801" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">label</span></span></span>  value as <em>white</em> on a <em>black</em> background on <b>Line 129</b>. By performing this masking, we are revealing <em>only</em> pixels that are part of the current connected component. An example of such a
			<span id="crayon-5827628cdde54928089195" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labelMask</span></span></span>  can be seen below:</p>
<div id="attachment_3009" style="width: 610px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_characters_label_mask.jpg"><img class="wp-image-3009" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_characters_label_mask.jpg" alt="Figure 7: Visualizing the current label of the connected-component. Here we can see the letter &quot;A&quot; and nothing else." width="600" height="268" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_characters_label_mask-300x134.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_characters_label_mask-865x387.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_characters_label_mask.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 7:</strong> Visualizing the current label of the connected-component. Here, we can see the letter &#8220;A&#8221; and nothing else.</p></div>
<p>Notice how <em>only</em> the <em>A</em> character of the license plate is shown and <em>nothing else</em>.</p>
<p>Now that we have the mask drawn, we find contours in the
			<span id="crayon-5827628cdde57632515010" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labelMask</span></span></span> , so we can apply <b><a href="https://gurus.pyimagesearch.com/lessons/contours/">contour properties</a></b> to determine if the contoured region is a character candidate or not:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde5a923006610" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))

		# extract the Value component from the HSV color space and apply adaptive thresholding
		# to reveal the characters on the license plate
		V = cv2.split(cv2.cvtColor(plate, cv2.COLOR_BGR2HSV))[2]
		thresh = threshold_adaptive(V, 30, offset=15).astype("uint8") * 255
		thresh = cv2.bitwise_not(thresh)

		# resize the license plate region to a canonical size
		plate = imutils.resize(plate, width=400)
		thresh = imutils.resize(thresh, width=400)
		cv2.imshow("Thresh", thresh)

		# perform a connected components analysis and initialize the mask to store the locations
		# of the character candidates
		labels = measure.label(thresh, neighbors=8, background=0)
		charCandidates = np.zeros(thresh.shape, dtype="uint8")

		# loop over the unique components
		for label in np.unique(labels):
			# if this is the background label, ignore it
			if label == -1:
				continue

			# otherwise, construct the label mask to display only connected components for the
			# current label, then find contours in the label mask
			labelMask = np.zeros(thresh.shape, dtype="uint8")
			labelMask[labels == label] = 255
			(cnts, _) = cv2.findContours(labelMask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

			# ensure at least one contour was found in the mask
			if len(cnts) &gt; 0:
				# grab the largest contour which corresponds to the component in the mask, then
				# grab the bounding box for the contour
				c = max(cnts, key=cv2.contourArea)
				(boxX, boxY, boxW, boxH) = cv2.boundingRect(c)

				# compute the aspect ratio, solidity, and height ratio for the component
				aspectRatio = boxW / float(boxH)
				solidity = cv2.contourArea(c) / float(boxW * boxH)
				heightRatio = boxH / float(plate.shape[0])

				# determine if the aspect ratio, solidity, and height of the contour pass
				# the rules tests
				keepAspectRatio = aspectRatio &lt; 1.0
				keepSolidity = solidity &gt; 0.15
				keepHeight = heightRatio &gt; 0.4 and heightRatio &lt; 0.95

				# check to see if the component passes all the tests
				if keepAspectRatio and keepSolidity and keepHeight:
					# compute the convex hull of the contour and draw it on the character
					# candidates mask
					hull = cv2.convexHull(c)
					cv2.drawContours(charCandidates, [hull], -1, 255, -1)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-132">132</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-134">134</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-136">136</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-138">138</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-140">140</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-142">142</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-144">144</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-146">146</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-148">148</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-150">150</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-152">152</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde5a923006610-154">154</div><div class="crayon-num" data-line="crayon-5827628cdde5a923006610-155">155</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-132"><span class="crayon-h">			</span><span class="crayon-c"># ensure at least one contour was found in the mask</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-133"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-134"><span class="crayon-h">				</span><span class="crayon-c"># grab the largest contour which corresponds to the component in the mask, then</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-135"><span class="crayon-h">				</span><span class="crayon-c"># grab the bounding box for the contour</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-136"><span class="crayon-h">				</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">cnts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">contourArea</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-137"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">boxX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxH</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">boundingRect</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-138">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde5a923006610-139"><span class="crayon-h">				</span><span class="crayon-c"># compute the aspect ratio, solidity, and height ratio for the component</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-140"><span class="crayon-h">				</span><span class="crayon-v">aspectRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxW</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">boxH</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-141"><span class="crayon-h">				</span><span class="crayon-v">solidity</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">contourArea</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">boxW</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">boxH</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-142"><span class="crayon-h">				</span><span class="crayon-v">heightRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxH</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">plate</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-143">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-144"><span class="crayon-h">				</span><span class="crayon-c"># determine if the aspect ratio, solidity, and height of the contour pass</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-145"><span class="crayon-h">				</span><span class="crayon-c"># the rules tests</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-146"><span class="crayon-h">				</span><span class="crayon-v">keepAspectRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">aspectRatio</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-147"><span class="crayon-h">				</span><span class="crayon-v">keepSolidity</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">solidity</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0.15</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-148"><span class="crayon-h">				</span><span class="crayon-v">keepHeight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">heightRatio</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">heightRatio</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0.95</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-149">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-150"><span class="crayon-h">				</span><span class="crayon-c"># check to see if the component passes all the tests</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-151"><span class="crayon-h">				</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">keepAspectRatio </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">keepSolidity </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">keepHeight</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-152"><span class="crayon-h">					</span><span class="crayon-c"># compute the convex hull of the contour and draw it on the character</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-153"><span class="crayon-h">					</span><span class="crayon-c"># candidates mask</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde5a923006610-154"><span class="crayon-h">					</span><span class="crayon-v">hull</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">convexHull</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde5a923006610-155"><span class="crayon-h">					</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">drawContours</span><span class="crayon-sy">(</span><span class="crayon-v">charCandidates</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">hull</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0377 seconds] -->
<p>
First, a check is made on <strong>Line 133</strong> to ensure that at least <em>one</em> contour was found in the
			<span id="crayon-5827628cdde60395268281" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labelMask</span></span></span> . If so, we grab the largest contour (according to the <strong><a href="https://gurus.pyimagesearch.com/topic/simple-contour-properties/">area</a></strong>) and compute its bounding box.</p>
<p>Based on the bounding box of the largest contour, we are now ready to compute a few more contour properties. The first is the
			<span id="crayon-5827628cdde63373216181" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">aspectRatio</span></span></span> , or simply the ratio of the bounding box width to the bounding box height. We&#8217;ll also compute the
			<span id="crayon-5827628cdde66320045281" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">solidity</span></span></span>  of the contour (refer to <strong><a href="https://gurus.pyimagesearch.com/topic/advanced-contour-properties/">advanced contour properties</a></strong> for more information on solidity). Last, we&#8217;ll also compute the
			<span id="crayon-5827628cdde68847040677" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">heightRatio</span></span></span> , or simply the ratio of the bounding box height to the license plate height. Large values of
			<span id="crayon-5827628cdde6b771088145" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">heightRatio</span></span></span>  indicate that the height of the (potential) character is similar to the license plate itself (and thus a likely character).</p>
<p>You&#8217;ve heard me say it many times inside this course, but I&#8217;ll say it again &#8212; <strong><em>a clever use of contour properties can often beat out more advanced computer vision techniques.</em></strong></p>
<p>The same is true for this lesson.</p>
<p>On <b>Lines 146-148</b>, we apply tests to determine if our aspect ratio, solidity, and height ratio are within acceptable bounds. We want our
			<span id="crayon-5827628cdde6d902679529" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">aspectRatio</span></span></span>  to be <em>at most</em> square, <em>ideally</em> taller rather than wide since most characters are taller than they are wide. We want our
			<span id="crayon-5827628cdde70481782739" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">solidity</span></span></span>  to be reasonably large, otherwise we could be investigating &#8220;noise&#8221;, such as dirt, bolts, etc. on the license plate. Finally, we want our
			<span id="crayon-5827628cdde72985150976" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">keepHeight</span></span></span>  ratio to be just the right size &#8212; license plate characters should span the majority of the height of a license plate, hence we specify a range that will catch all characters present on the license plates.</p>
<p>It&#8217;s important to note that these values were experimentally tuned based on our license plate dataset. For other license plate datasets these values may need to be changed &#8212; and that&#8217;s totally okay. There is no &#8220;silver bullet&#8221; for ANPR; each system is geared towards solving a very particular problem. When you go to develop your own ANPR systems, be sure to pay attention to these contour property rules. It may be the case that you need to experiment with them to determine appropriate values.</p>
<p>Provided that our aspect ratio, solidity, and height ratio tests pass, we take the contour, compute the convex hull (to ensure the <em>entire</em> bounding region of the character is included in the contour), and draw the convex hull on our
			<span id="crayon-5827628cdde75881500159" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">charCandidates</span></span></span>  mask. Here are a few examples of computing license plate character regions:</p>
<div id="attachment_3011" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_correct.jpg"><img class="wp-image-3011" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_correct.jpg" alt="Figure 8: Samples of computing the perspective transform of the license plate (top), thresholding it (center), and computing the convex hull for each character on the license plate." width="800" height="595" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_correct-300x223.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_correct.jpg 858w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 8:</strong> Samples of computing the perspective transform of the license plate (top), thresholding it (center), and computing the convex hull for each character on the license plate.</p></div>
<p>Notice in each case how the character is entirely contained within the convex hull mask &#8212; this will make it very easy for us to extract each character ROI from the license plate in the next lesson.</p>
<p>At this point, we&#8217;re just about done with our
			<span id="crayon-5827628cdde78066250528" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detectCharacterCandidates</span></span></span>  method, so let&#8217;s finish it up:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde7a932145120" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">license_plate.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from collections import namedtuple
from skimage.filter import threshold_adaptive
from skimage import segmentation
from skimage import measure
from imutils import perspective
import numpy as np
import imutils
import cv2

# define the named tupled to store the license plate
LicensePlate = namedtuple("LicensePlateRegion", ["success", "plate", "thresh", "candidates"])

class LicensePlateDetector:
	def __init__(self, image, minPlateW=60, minPlateH=20, numChars=7, minCharW=40):
		# store the image to detect license plates in, the minimum width and height of the
		# license plate region, the number of characters to be detected in the license plate,
		# and the minimum width of the extracted characters
		self.image = image
		self.minPlateW = minPlateW
		self.minPlateH = minPlateH
		self.numChars = numChars
		self.minCharW = minCharW

	def detect(self):
		# detect license plate regions in the image
		lpRegions = self.detectPlates()

		# loop over the license plate regions
		for lpRegion in lpRegions:
			# detect character candidates in the current license plate region
			lp = self.detectCharacterCandidates(lpRegion)

			# only continue if characters were successfully detected
			if lp.success:
				# yield a tuple of the license plate object and bounding box
				yield (lp, lpRegion)

	def detectPlates(self):
		# initialize the rectangular and square kernels to be applied to the image,
		# then initialize the list of license plate regions
		rectKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (13, 5))
		squareKernel = cv2.getStructuringElement(cv2.MORPH_RECT, (3, 3))
		regions = []

		# convert the image to grayscale, and apply the blackhat operation
		gray = cv2.cvtColor(self.image, cv2.COLOR_BGR2GRAY)
		blackhat = cv2.morphologyEx(gray, cv2.MORPH_BLACKHAT, rectKernel)

		# find regions in the image that are light
		light = cv2.morphologyEx(gray, cv2.MORPH_CLOSE, squareKernel)
		light = cv2.threshold(light, 50, 255, cv2.THRESH_BINARY)[1]

		# compute the Scharr gradient representation of the blackhat image in the y-direction,
		# and scale the resulting image into the range [0, 255]
		gradY = cv2.Sobel(blackhat, ddepth=cv2.cv.CV_32F, dx=1, dy=0, ksize=-1)
		gradY = np.absolute(gradY)
		(minVal, maxVal) = (np.min(gradY), np.max(gradY))
		gradY = (255 * ((gradY - minVal) / (maxVal - minVal))).astype("uint8")

		# blur the gradient representation, apply a closing operation, and threshold the
		# image using Otsu's method
		gradY = cv2.GaussianBlur(gradY, (5, 5), 0)
		gradY = cv2.morphologyEx(gradY, cv2.MORPH_CLOSE, rectKernel)
		thresh = cv2.threshold(gradY, 0, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)[1]

		# perform a series of erosions and dilations on the image
		thresh = cv2.erode(thresh, None, iterations=2)
		thresh = cv2.dilate(thresh, None, iterations=2)

		# take the bitwise 'and' between the 'light' regions of the image, then perform
		# another series of erosions and dilations
		thresh = cv2.bitwise_and(thresh, thresh, mask=light)
		thresh = cv2.dilate(thresh, None, iterations=2)
		thresh = cv2.erode(thresh, None, iterations=1)

		# find contours in the thresholded image
		(cnts, _) = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

		# loop over the contours
		for c in cnts:
			# grab the bounding box associated with the contour and compute the area and
			# aspect ratio
			(w, h) = cv2.boundingRect(c)[2:]
			aspectRatio = w / float(h)

			# compute the rotated bounding box of the region
			rect = cv2.minAreaRect(c)
			box = np.int0(cv2.cv.BoxPoints(rect))

			# ensure the aspect ratio, width, and height of the bounding box fall within
			# tolerable limits, then update the list of license plate regions
			if (aspectRatio &gt; 3 and aspectRatio &lt; 6) and h &gt; self.minPlateH and w &gt; self.minPlateW:
				regions.append(box)

		# return the list of license plate regions
		return regions

	def detectCharacterCandidates(self, region):
		# apply a 4-point transform to extract the license plate
		plate = perspective.four_point_transform(self.image, region)
		cv2.imshow("Perspective Transform", imutils.resize(plate, width=400))

		# extract the Value component from the HSV color space and apply adaptive thresholding
		# to reveal the characters on the license plate
		V = cv2.split(cv2.cvtColor(plate, cv2.COLOR_BGR2HSV))[2]
		thresh = threshold_adaptive(V, 30, offset=15).astype("uint8") * 255
		thresh = cv2.bitwise_not(thresh)

		# resize the license plate region to a canonical size
		plate = imutils.resize(plate, width=400)
		thresh = imutils.resize(thresh, width=400)
		cv2.imshow("Thresh", thresh)

		# perform a connected components analysis and initialize the mask to store the locations
		# of the character candidates
		labels = measure.label(thresh, neighbors=8, background=0)
		charCandidates = np.zeros(thresh.shape, dtype="uint8")

		# loop over the unique components
		for label in np.unique(labels):
			# if this is the background label, ignore it
			if label == -1:
				continue

			# otherwise, construct the label mask to display only connected components for the
			# current label, then find contours in the label mask
			labelMask = np.zeros(thresh.shape, dtype="uint8")
			labelMask[labels == label] = 255
			(cnts, _) = cv2.findContours(labelMask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

			# ensure at least one contour was found in the mask
			if len(cnts) &gt; 0:
				# grab the largest contour which corresponds to the component in the mask, then
				# grab the bounding box for the contour
				c = max(cnts, key=cv2.contourArea)
				(boxX, boxY, boxW, boxH) = cv2.boundingRect(c)

				# compute the aspect ratio, solidity, and height ratio for the component
				aspectRatio = boxW / float(boxH)
				solidity = cv2.contourArea(c) / float(boxW * boxH)
				heightRatio = boxH / float(plate.shape[0])

				# determine if the aspect ratio, solidity, and height of the contour pass
				# the rules tests
				keepAspectRatio = aspectRatio &lt; 1.0
				keepSolidity = solidity &gt; 0.15
				keepHeight = heightRatio &gt; 0.4 and heightRatio &lt; 0.95

				# check to see if the component passes all the tests
				if keepAspectRatio and keepSolidity and keepHeight:
					# compute the convex hull of the contour and draw it on the character
					# candidates mask
					hull = cv2.convexHull(c)
					cv2.drawContours(charCandidates, [hull], -1, 255, -1)

		# clear pixels that touch the borders of the character candidates mask and detect
		# contours in the candidates mask
		charCandidates = segmentation.clear_border(charCandidates)

		# TODO:
		# There will be times when we detect more than the desired number of characters --
		# it would be wise to apply a method to 'prune' the unwanted characters

		# return the license plate region object containing the license plate, the thresholded
		# license plate, and the character candidates
		return LicensePlate(success=True, plate=plate, thresh=thresh,
			candidates=charCandidates)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-158">158</div><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-160">160</div><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-162">162</div><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-164">164</div><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-166">166</div><div class="crayon-num" data-line="crayon-5827628cdde7a932145120-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde7a932145120-168">168</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde7a932145120-157"><span class="crayon-h">		</span><span class="crayon-c"># clear pixels that touch the borders of the character candidates mask and detect</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-158"><span class="crayon-h">		</span><span class="crayon-c"># contours in the candidates mask</span></div><div class="crayon-line" id="crayon-5827628cdde7a932145120-159"><span class="crayon-h">		</span><span class="crayon-v">charCandidates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">segmentation</span><span class="crayon-sy">.</span><span class="crayon-e">clear_border</span><span class="crayon-sy">(</span><span class="crayon-v">charCandidates</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-160">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde7a932145120-161"><span class="crayon-h">		</span><span class="crayon-c"># TODO:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-162"><span class="crayon-h">		</span><span class="crayon-c"># There will be times when we detect more than the desired number of characters --</span></div><div class="crayon-line" id="crayon-5827628cdde7a932145120-163"><span class="crayon-h">		</span><span class="crayon-c"># it would be wise to apply a method to 'prune' the unwanted characters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-164">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde7a932145120-165"><span class="crayon-h">		</span><span class="crayon-c"># return the license plate region object containing the license plate, the thresholded</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-166"><span class="crayon-h">		</span><span class="crayon-c"># license plate, and the character candidates</span></div><div class="crayon-line" id="crayon-5827628cdde7a932145120-167"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">LicensePlate</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">plate</span><span class="crayon-o">=</span><span class="crayon-v">plate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thresh</span><span class="crayon-o">=</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde7a932145120-168"><span class="crayon-h">			</span><span class="crayon-v">candidates</span><span class="crayon-o">=</span><span class="crayon-v">charCandidates</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0368 seconds] -->
<p>
On <strong>Line 159</strong>, we make a call to
			<span id="crayon-5827628cdde81448771205" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">clear_border</span></span></span> . The
			<span id="crayon-5827628cdde84744287153" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">clear_border</span></span></span>  function performs a connected component analysis, and any components that are &#8220;touching&#8221; the borders of the image are removed. This function is very useful in the oft case our contour property tests has a false-positive and accidentally marks a region as a character when it was really part of the license plate border.</p>
<p>You&#8217;ll also notice that I have placed a
			<span id="crayon-5827628cdde87400721893" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">TODO</span></span></span>  stub on <strong>Lines 161-163</strong>. Despite our best efforts, there will still be cases when our contour property tests are just not enough and we accidentally mark regions of the license plate characters when in reality they are not. Below are a few examples of such a false classification:</p>
<div id="attachment_3010" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues.jpg"><img class="wp-image-3010" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues.jpg" alt="Figure 9: Examples of connected-components (i.e. extraneous parts of the license plate) that were falsely labeled as characters." width="800" height="212" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues-300x79.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues-1024x271.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues-865x229.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues-1204x318.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_extracted_issues.jpg 1286w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 9:</strong> Examples of connected-components (i.e. extraneous parts of the license plate) that were falsely labeled as characters.</p></div>
<p>So how might we go about getting rid of these regions? The answer is to apply <i>character pruning</i> where we loop over the character candidates and remove the &#8220;outliers&#8221; from the group. We&#8217;ll cover the character pruning stage in our next lesson.</p>
<p>Remember, each and every stage of your computer vision pipeline (ANPR or not) <em>does not</em> have to be 100% perfect. Instead, it can make a few mistakes and let them pass through &#8212; we&#8217;ll just build in traps and mechanisms to catch these mistakes later on in the pipeline when they are (ideally) easier to identify!</p>
<p>Finally, we construct a
			<span id="crayon-5827628cdde8a573613535" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>  object (<strong>Line 167</strong>) consisting of the license plate, thresholded license plate, and license plate characters and return it to the calling function.</p>
<h2>Updating the driver script</h2>
<p>Now that we have updated our
			<span id="crayon-5827628cdde8d854161759" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlateDetector</span></span></span>  class, let&#8217;s also update our
			<span id="crayon-5827628cdde8f892350061" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognize</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>  driver script, so we can see our results in action:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde92249774579" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">recognize.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
# import the necessary packages
from __future__ import print_function
from pyimagesearch.license_plate import LicensePlateDetector
from imutils import paths
import numpy as np
import argparse
import imutils
import cv2

# construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-i", "--images", required=True, help="path to the images to be classified")
args = vars(ap.parse_args())

# loop over the images
for imagePath in sorted(list(paths.list_images(args["images"]))):
	# load the image
	image = cv2.imread(imagePath)
	print(imagePath)

	# if the width is greater than 640 pixels, then resize the image
	if image.shape[1] &gt; 640:
		image = imutils.resize(image, width=640)

	# initialize the license plate detector and detect the license plates and candidates
	lpd = LicensePlateDetector(image)
	plates = lpd.detect()

	# loop over the license plate regions
	for (i, (lp, lpBox)) in enumerate(plates):
		# draw the bounding box surrounding the license plate
		cv2.drawContours(image, [lpBox], -1, (0, 255, 0), 2)

		# show the output images
		candidates = np.dstack([lp.candidates] * 3)
		thresh = np.dstack([lp.thresh] * 3)
		output = np.vstack([lp.plate, thresh, candidates])
		cv2.imshow("Plate &amp; Candidates #{}".format(i + 1), output)

	# display the output image
	cv2.imshow("Image", image)
	cv2.waitKey(0)
	cv2.destroyAllWindows()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde92249774579-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-2">2</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-4">4</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-6">6</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-8">8</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-10">10</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-12">12</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-14">14</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-16">16</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-18">18</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-20">20</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-22">22</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-24">24</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-26">26</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-28">28</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-30">30</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-32">32</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-34">34</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-36">36</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-38">38</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-40">40</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5827628cdde92249774579-42">42</div><div class="crayon-num" data-line="crayon-5827628cdde92249774579-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde92249774579-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">__future__</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">print_function</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">license_plate </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LicensePlateDetector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">imutils </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">paths</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-10"><span class="crayon-c"># construct the argument parser and parse the arguments</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-11"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-12"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--images"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to the images to be classified"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-13"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-14">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde92249774579-15"><span class="crayon-c"># loop over the images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-16"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">imagePath </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">sorted</span><span class="crayon-sy">(</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-e">list_images</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"images"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-17"><span class="crayon-h">	</span><span class="crayon-c"># load the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-18"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-19"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-20">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde92249774579-21"><span class="crayon-h">	</span><span class="crayon-c"># if the width is greater than 640 pixels, then resize the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-22"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">640</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-23"><span class="crayon-h">		</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">640</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-24">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde92249774579-25"><span class="crayon-h">	</span><span class="crayon-c"># initialize the license plate detector and detect the license plates and candidates</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-26"><span class="crayon-h">	</span><span class="crayon-v">lpd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LicensePlateDetector</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-27"><span class="crayon-h">	</span><span class="crayon-v">plates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lpd</span><span class="crayon-sy">.</span><span class="crayon-e">detect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-28">&nbsp;</div><div class="crayon-line" id="crayon-5827628cdde92249774579-29"><span class="crayon-h">	</span><span class="crayon-c"># loop over the license plate regions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-30"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">lp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lpBox</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">plates</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-31"><span class="crayon-h">		</span><span class="crayon-c"># draw the bounding box surrounding the license plate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-32"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">drawContours</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">lpBox</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-34"><span class="crayon-h">		</span><span class="crayon-c"># show the output images</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-35"><span class="crayon-h">		</span><span class="crayon-v">candidates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dstack</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">lp</span><span class="crayon-sy">.</span><span class="crayon-v">candidates</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-36"><span class="crayon-h">		</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dstack</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">lp</span><span class="crayon-sy">.</span><span class="crayon-v">thresh</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-37"><span class="crayon-h">		</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">lp</span><span class="crayon-sy">.</span><span class="crayon-v">plate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">candidates</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-38"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Plate &amp; Candidates #{}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-40"><span class="crayon-h">	</span><span class="crayon-c"># display the output image</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-41"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5827628cdde92249774579-42"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5827628cdde92249774579-43"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">destroyAllWindows</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0074 seconds] -->
<p>
Compared to our <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">previous lesson</a></strong>, not much has changed. We are still detecting the license plates on <strong>Line 27</strong>. And we are still looping over each of the license plate regions on <strong>Line 30</strong>; however, this time we are looping over a 2-tuple: the
			<span id="crayon-5827628cdde96735067492" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LicensePlate</span></span></span>  object (i.e.
			<span id="crayon-5827628cdde98008860439" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">namedtuple</span></span></span> ) and the
			<span id="crayon-5827628cdde9b744322293" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-ubuntu-mono" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important;"><span class="crayon-pre crayon-code" style="font-size: 14px !important; line-height: 17px !important;font-size: 14px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">lpBox</span></span></span>  (i.e. license plate bounding box).</p>
<p>For each of the license plate candidates, we construct an output image containing the (1) perspective transformed license plate region, (2) the binarized license plate region obtained using adaptive thresholding, and (3) the license plate character candidates after computing the convex hull (<strong>Lines 35-38</strong>).</p>
<p>To see our script in action, just execute the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5827628cdde9d777598238" class="crayon-syntax crayon-theme-arduino-ide crayon-font-ubuntu-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 17px !important;">

			<div class="crayon-toolbar" data-settings=" show" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span class="crayon-title">recognize.py</span>
			<div class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 17px !important;">
$ python recognize.py --images ../testing_lp_dataset</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5827628cdde9d777598238-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5827628cdde9d777598238-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">images</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-v">testing_lp_dataset</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>
<div id="attachment_3012" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02.jpg"><img class="wp-image-3012" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02.jpg" alt="Figure 10: Detecting the license plate in the image, followed by extracting character regions from the license plate." width="800" height="500" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02-300x188.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02-1024x640.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02-865x541.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02-1204x753.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_02.jpg 1500w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 10:</strong> Detecting the license plate in the image, followed by extracting character regions from the license plate.</p></div>
<div id="attachment_3016" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01.jpg"><img class="wp-image-3016" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01.jpg" alt="Figure 11: A second example of license plate detection + character hypothesis generation." width="800" height="500" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01-300x188.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01-1024x640.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01-865x541.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01-1204x753.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_01.jpg 1500w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 11:</strong> A second example of license plate detection and character hypothesis generation.</p></div>
<div id="attachment_3014" style="width: 810px" class="wp-caption aligncenter"><a href="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg"><img class="wp-image-3014" src="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg" alt="Figure 12: Our ANPR pipeline once again able to locate the license plate region in the image and segment the foreground characters from the background license plate." width="800" height="500" srcset="https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-300x188.jpg 300w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-1024x640.jpg 1024w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-865x541.jpg 865w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03-1204x753.jpg 1204w, https://gurus.pyimagesearch.com/wp-content/uploads/2015/03/anpr_segmenting_chars_results_03.jpg 1500w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><strong>Figure 12:</strong> Our ANPR pipeline is once again able to locate the license plate region in the image and segment the foreground characters from the background license plate.</p></div>
<h1>Summary</h1>
<p>We started this lesson by building on our previous knowledge of <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">license plate localization</a></strong>. We extended our license plate localizer to <em>segment</em> license plate characters from the license plate itself using image processing techniques, including adaptive thresholding, connected component analysis, and contour properties.</p>
<p>In most cases, our character segmentation algorithm worked quite well; however, there were some cases where our aspect ratio, solidity, and height ratio tests generated false positives, leaving us with falsely detected characters.</p>
<p>As we&#8217;ll see in our next lesson, these false positives are not as big of a deal as they may seem. Using the geometry of the license plate (i.e. the license plate characters should appear in a <em>single row</em>), it will actually be fairly easy for us to prune out these false positives and be left with only the <em>actual</em> license plate characters.</p>
<p>Remember, every stage of your computer vision pipeline does not have to be 100% correct every single time. Instead, it may be beneficial to pass on less-than-perfect results to the next stage of your pipeline where you can detect these problem regions and throw them away.</p>
<p>For example, consider the <strong><a href="https://gurus.pyimagesearch.com/lessons/localizing-license-plates-in-images/">license plate localization</a> lesson </strong>where we accidentally detected a few regions of an image that weren&#8217;t actually license plates. Instead of agonizing over these false positives and trying to make the morphological operations and contour properties work <em>perfectly</em>, it&#8217;s instead easier to pass them on to the next stage of our ANPR pipeline where we perform character detection. If we cannot detect characters on these license plate candidates, we just throw them out &#8212; problem solved!</p>
<p>Solving computer vision problems is only partially based on your knowledge of the subject &#8212; the other half comes from your creativity, and your ability to look at a problem differently and arrive at an innovative (yet simple) solution.</p>
<h1>Downloads:</h1>
<p><a class="x-btn x-btn-real x-btn-rounded x-btn-x-large" href="https://gurus.pyimagesearch.com/protected/code/anpr/segmenting_characters.zip" data-options="thumbnail: ''">Download the Code</a></p>


</div>


  <footer class="entry-footer cf">
    <p><i class="x-icon-tags" data-x-icon="&#xf02c;"></i> Tags: <a href="https://gurus.pyimagesearch.com/tag/sample-lesson/" rel="tag">sample lesson</a></p>  </footer>
  </div>
</article>

    </div>




  <aside class="x-sidebar right" role="complementary">
          <div id="pyimgtourwidget-2" class="widget widget_pyimgtourwidget"><div class="widget widget-text pyimg_tour_signup_widget_box">
	<h4 class="h-widget">Ready to join the course?</h4>	<p>
		Learning computer vision &amp; OpenCV used to be <strong><em>hard</em></strong>. <strong>But not anymore.</strong> Click the button below to join the PyImageSearch Gurus course and start your journey to computer vision mastery.
	</p>
	<a href="#">Join the course!</a>
</div>
</div>      </aside>


  </div>






  <a class="x-scroll-top right fade" href="#top" title="Back to Top">
    <i class="x-icon-angle-up" data-x-icon="&#xf106;"></i>
  </a>

  <script>

  jQuery(document).ready(function($) {

    var windowObj            = $(window);
    var body                 = $('body');
    var bodyOffsetBottom     = windowObj.scrollBottom();             // 1
    var bodyHeightAdjustment = body.height() - bodyOffsetBottom;     // 2
    var bodyHeightAdjusted   = body.height() - bodyHeightAdjustment; // 3
    var scrollTopAnchor      = $('.x-scroll-top');

    function sizingUpdate(){
      var bodyOffsetTop = windowObj.scrollTop();
      if ( bodyOffsetTop > ( bodyHeightAdjusted * 0.75 ) ) {
        scrollTopAnchor.addClass('in');
      } else {
        scrollTopAnchor.removeClass('in');
      }
    }

    windowObj.bind('scroll', sizingUpdate).resize(sizingUpdate);
    sizingUpdate();

    scrollTopAnchor.click(function(){
      $('html,body').animate({ scrollTop: 0 }, 850, 'easeInOutExpo');
      return false;
    });

  });

  </script>




    <footer class="x-colophon bottom" role="contentinfo">
      <div class="x-container max width">



                  <div class="x-colophon-content">
            <p>&copy; 2015 PyImageSearch. All Rights Reserved.</p>          </div>

      </div>
    </footer>




  </div> <!-- END #top.site -->


<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '4768429';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/4768429.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>

<script type="text/javascript">
jQuery(document).ready(function(){
  // extract the path from the URL
  path = window.location.pathname.substring(1);
  path = path.substring(0, path.indexOf("/"));

  // check if this is the thank you page
  if (path == "thank-you"){
    // track that the user has made a purchase
    window._dcq = window._dcq || [];
    window._dcq.push(["track", "purchased gurus membership", {}]);
  }

  // check if this is the registration page
  else if (path == "register"){
    // grab reference to Drip
    window._dcq = window._dcq || [];

    // check to see if the user is checking out
    if (window.location.search.indexOf("action=checkout") != -1){
      // track that the user has started checkout
      window._dcq.push(["track", "started gurus checkout", {}]);
    }

    else{
      // track that the user is registering
      window._dcq.push(["track", "viewed gurus registration", {}]);
    }
  }
});
</script>
<div id="un-thankyou" style="display: none;">
	<h2>Thank you!</h2>
	<p>
		Your message has been received, I will get back to you ASAP!	</p>
	<a href="#" id="un-feedback-close"><img src="https://gurus.pyimagesearch.com/wp-content/plugins/usernoise/images/ok.png" id="thankyou-image" alt="Close" width="32" height="32"/></a>
</div>
<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.perfectaudience.com/serve/54220efd7ab7f03f7e000043.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script><!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '4768429';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/4768429.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><link rel='stylesheet' id='badgeos-front-css'  href='https://gurus.pyimagesearch.com/wp-content/plugins/badgeos/css/badgeos-front.css?ver=1.0.1' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var thickboxL10n = {"next":"Next >","prev":"< Prev","image":"Image","of":"of","close":"Close","noiframes":"This feature requires inline frames. You have iframes disabled or your browser does not support them.","loadingAnimation":"https:\/\/gurus.pyimagesearch.com\/wp-includes\/js\/thickbox\/loadingAnimation.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-includes/js/thickbox/thickbox.js?ver=3.1-20121105'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/badgeos/js/credly-badge-builder.js?ver=1.3.0'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var badgeos_feedback_buttons = {"ajax_url":"\/wp-admin\/admin-ajax.php","user_id":"0"};
var badgeos_feedback_buttons = {"ajax_url":"\/wp-admin\/admin-ajax.php","user_id":"0"};
var BadgeosCredlyData = {"ajax_url":"\/wp-admin\/admin-ajax.php","message":"Would you like to display this badge on social networks and add it to your lifelong badge collection?","confirm":"Yes, send to Credly","cancel":"Cancel","share":"Share on Credly!","localized_error":"Error:","errormessage":"Error: Timed out"};
/* ]]> */
</script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/badgeos/js/badgeos-achievements.js?ver=1.1.0'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/contact-form-7/includes/js/jquery.form.min.js?ver=3.51.0-2014.06.20'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var _wpcf7 = {"loaderUrl":"https:\/\/gurus.pyimagesearch.com\/wp-content\/plugins\/contact-form-7\/images\/ajax-loader.gif","recaptchaEmpty":"Please verify that you are not a robot.","sending":"Sending ..."};
/* ]]> */
</script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.4.1'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/themes/x/framework/js/dist/site/x-body.min.js?ver=4.3.4'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/x-shortcodes/js/dist/site/x-shortcodes-body.min.js?ver=3.0.5'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-includes/js/wp-embed.min.js?ver=4.4.2'></script>
<script type='text/javascript' src='https://gurus.pyimagesearch.com/wp-content/plugins/sfwd-lms/templates/learndash_template_script.js?ver=4.4.2'></script>


    <script id="x-customizer-js">
      // if the unauthorized login link is on the page, remove it
if (jQuery("div.mepr-unauthorized-message").length){
jQuery(document).ready(function(){jQuery("div.mepr-login-form-wrap").hide();});}

// if the unauthorized query string is set, then hide the introductory login
if (location.search.indexOf("action=mepr_unauthorized") != -1){jQuery("p.gurus_login_info").hide();}

jQuery(".achievement_tweet").click(function(e){
	e.preventDefault();
	win = window.open(jQuery(this).attr("href"), 'Post on Twitter','height=350,width=600');
	if (window.focus){win.focus()}
	return false;
});    </script>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61169353-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
